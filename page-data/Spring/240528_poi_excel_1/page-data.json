{"componentChunkName":"component---src-templates-blog-post-js","path":"/Spring/240528_poi_excel_1/","result":{"data":{"site":{"siteMetadata":{"title":"32's Dev.log","author":"han32","siteUrl":"https://gatsby-starter-bee.netlify.com","comment":{"disqusShortName":"","utterances":"HSangMi/devlog"},"sponsor":{"buyMeACoffeeId":"han32"}}},"markdownRemark":{"id":"a59e687b-7db8-523f-93b3-afe6ac85d5e8","excerpt":"Apache POI Library Java 코드 상에서 Excel 파일을 생성해주는 library입니다. 해당 library를 쓰다보면 엑셀 생성의 핵심인 Workbook을 생성하게 됩는데, Workbook 종류는 3가지가 있습니다. HSSF Workbook  XSSF Workbook SXSSF Workbook Workbook 비교 생성할 데이터에 따라 적절한 WorkBook을 선택해서 개발하면 됩니다  HSSF XSSF SXSSF 버전,호환성 excel 97 ~ 2003 버전 excel 200…","html":"<h3 id=\"apache-poi-library\" style=\"position:relative;\"><a href=\"#apache-poi-library\" aria-label=\"apache poi library permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Apache POI Library</h3>\n<p>Java 코드 상에서 Excel 파일을 생성해주는 library입니다.</p>\n<p>해당 library를 쓰다보면 엑셀 생성의 핵심인 Workbook을 생성하게 됩는데, Workbook 종류는 3가지가 있습니다.</p>\n<ol>\n<li><strong>HSSF Workbook</strong> </li>\n<li><strong>XSSF Workbook</strong></li>\n<li><strong>SXSSF Workbook</strong></li>\n</ol>\n<h3 id=\"workbook-비교\" style=\"position:relative;\"><a href=\"#workbook-%EB%B9%84%EA%B5%90\" aria-label=\"workbook 비교 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Workbook 비교</h3>\n<ul>\n<li>생성할 데이터에 따라 적절한 WorkBook을 선택해서 개발하면 됩니다</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>HSSF</th>\n<th>XSSF</th>\n<th>SXSSF</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>버전,호환성</td>\n<td>excel 97 ~ 2003 버전</td>\n<td>excel 2007 이상의 버전</td>\n<td>POI 3.8 beta3 버전부터 지원하는 성능개선 버전</td>\n</tr>\n<tr>\n<td>AbstractView 구현체</td>\n<td>AbstractXlsView</td>\n<td>AbstractXlsxView</td>\n<td>AbstractXlsxStreamingView</td>\n</tr>\n<tr>\n<td>확장자</td>\n<td>.xls</td>\n<td>.xlsx (1,048,576행)</td>\n<td>.xlsx (1,048,576행)</td>\n</tr>\n<tr>\n<td>속도</td>\n<td>빠름</td>\n<td>느림</td>\n<td>빠름</td>\n</tr>\n<tr>\n<td>특징</td>\n<td></td>\n<td>- XML 기반으로, 메모리 사용 공간이 HSSF 보다 높음</td>\n<td>- 대용량 sheet 생성 시 사용</td>\n</tr>\n<tr>\n<td>제한 사항</td>\n<td>row수 제한 : 65,535 (이후 row 생성 시 에러 발생)</td>\n<td>row수 제한 없음</td>\n<td>- row수 제한 없음(단, flushRows 필요) <br>- 쓰기 전용이라 기존 엑셀 읽지 못함 <br>- Sheet.clone()은 지원되지 않는다 <br>- excel 기능중 하나인 ‘Formula evaluation’는 지원 되지 않는다.</td>\n</tr>\n</tbody>\n</table>\n<aside>\n💡 현재 참여중인 솔루션에선 XSSF을 사용하고 있는데, 엑셀로 통계를 보고싶어 하는 고객 요구사항이 많이 추가적으로 들어오기도 하고 대용량 데이터를 반출하는 경우 속도이슈가 있어, SXSSF 방식으로 전환해 볼까 한다.\n</aside>\n<h3 id=\"apache-poi-abstractview를-사용해서-excel-다운로드가-이루어지는-과정\" style=\"position:relative;\"><a href=\"#apache-poi-abstractview%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%84%9C-excel-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%EA%B0%80-%EC%9D%B4%EB%A3%A8%EC%96%B4%EC%A7%80%EB%8A%94-%EA%B3%BC%EC%A0%95\" aria-label=\"apache poi abstractview를 사용해서 excel 다운로드가 이루어지는 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Apache POI, AbstractView를 사용해서 Excel 다운로드가 이루어지는 과정</h3>\n<ol>\n<li><strong>클라이언트 요청</strong></li>\n<li><strong>Controller 처리</strong>: 요청을 처리하는 Controller 메서드가 실행되고 서비스 로직을 처리 후 엑셀로 생성할 데이터를 모델에 추가하고 <strong><code class=\"language-text\">ModelAndView</code></strong>를 반환.</li>\n<li><strong>ViewResolver 동작 (AbstractView)</strong> </li>\n<li><strong>AbstractView 확장한 추상클래스 구현체에서 rendering</strong> : 엑셀 파일 생성하고 응답 스트림에 작성 </li>\n<li><strong>브라우저에서 다운로드</strong></li>\n</ol>\n<aside>\n❓ 어떻게 View를 반환하는 것으로 엑셀파일을 다운로드 시켜주는 걸까?\n</aside>\n<h3 id=\"abstractview-\" style=\"position:relative;\"><a href=\"#abstractview-\" aria-label=\"abstractview  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AbstractView ?</h3>\n<ul>\n<li><code class=\"language-text\">AbstractView</code>는 Spring MVC에서 특정한 뷰를 생성하는 데 사용되는 추상 클래스입니다.</li>\n<li>이 클래스는 클라이언트 요청에 대한 응답으로 <strong>특정 형식의 출력</strong>을 생성하는 방법을 정의합니다.</li>\n<li>\n<p><code class=\"language-text\">AbstractView</code>의 서브클래스 중 하나인 <code class=\"language-text\">AbstractXlsxView</code>는 Excel 파일을 생성하는 데 사용됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 318px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACMUlEQVQ4y52U2ZLaMBBF+ZYkE7zvmMU2xmDjjdVhUlNJ3vL/33DTamPGMDBU5eFWtyTrqqVjaaCqKvpSFAW6rsMbeSzHcViuP4NtW3BcB57nwrIs/vZ2/uC2Q5ZlOLaN/M9fLOoliqrC/njCdrcjHbA7/CA1CIIAkiQ9NxSrGoaBcTiH53uYTMaIkjXi/IjZbIbpLEAQhnBdlxf/1LDbgogyrS6iNHyBavmw4yOG37+yiXQe68/5YHhlRmqjzFFIM71L3tet6d0KTdqyZZiwTIu2r5Mo9yacizGDoJmmwfAeVsiGJE2WkGwaZG9vWKUxDs1PgrFHVROc5pUANQylrDZM//Yc71SoYDQNMI4i+JMR5vECSVZiVTWI5jErXiQIozlX+/kZinMROa2q8MGrBOIbNHsMZ9Fg+NJBGVJsx9XeWT6Eci31DMX9XygaAdEZimmaDMCgaHtTyjX+RxkO9T2HIq6dpiI9/UKyLbBMl9jsjijrDUGoKT8wjKrectsfjZ5DEYZBmmMahwiiEGmWI11XSMs9lquUFsmQrDKODynfli3ToSuSTB8rDEKzp3CSV8q/8C0RUPq3pe8xuA+j/Sf7E3Tb/7DwPThXFeqq2LJO0ritdaK24YwpV977LmPt+KXC7skSb116+o2kXNENSVFvd8iLEkVZMYSirFldH0cCI+CIp6w7y9aQ3C36DaJii1kS0u2IUZDJuqha5SWys3IyTdcFmW2oXdB4SU/c5GL4D27dOd54mvCFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AbstractView\"\n        title=\"AbstractView\"\n        src=\"/devlog/static/042989804880a433cb305f1601faf007/cd2d9/abstractView.png\"\n        srcset=\"/devlog/static/042989804880a433cb305f1601faf007/5a46d/abstractView.png 300w,\n/devlog/static/042989804880a433cb305f1601faf007/cd2d9/abstractView.png 318w\"\n        sizes=\"(max-width: 318px) 100vw, 318px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</li>\n</ul>\n<h3 id=\"abstractview-처리-프로세스\" style=\"position:relative;\"><a href=\"#abstractview-%EC%B2%98%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4\" aria-label=\"abstractview 처리 프로세스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>AbstractView 처리 프로세스</strong></h3>\n<p><strong><code class=\"language-text\">AbstractView</code></strong>를 확장한 뷰 클래스가 처리되는 일반적인 프로세스는 다음과 같습니다:</p>\n<ol>\n<li><strong>클라이언트 요청 수신</strong>: 클라이언트가 특정 URL로 요청을 보냅니다.</li>\n<li><strong>요청 매핑 및 처리</strong>: Spring MVC 컨트롤러가 요청을 매핑하고, 적절한 요청 핸들러 메서드를 실행합니다.</li>\n<li><strong>ModelAndView 반환</strong>: 요청 핸들러 메서드는 <strong><code class=\"language-text\">ModelAndView</code></strong> 객체를 반환합니다. 이 객체에는 뷰 이름 또는 뷰 객체와 모델 데이터가 포함됩니다.</li>\n<li><strong>뷰 리졸버</strong>: Spring MVC의 뷰 리졸버가 <strong><code class=\"language-text\">ModelAndView</code></strong> 객체를 기반으로 적절한 뷰를 찾습니다.</li>\n<li><strong>뷰 렌더링</strong>: 찾은 뷰 객체의 <strong><code class=\"language-text\">render</code></strong> 메서드가 호출되어 클라이언트에게 반환할 응답을 생성합니다.</li>\n</ol>\n<h3 id=\"abstractxlsxview-클래스의-동작-과정\" style=\"position:relative;\"><a href=\"#abstractxlsxview-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EB%8F%99%EC%9E%91-%EA%B3%BC%EC%A0%95\" aria-label=\"abstractxlsxview 클래스의 동작 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>AbstractXlsxView 클래스의 동작 과정</strong></h3>\n<p><strong><code class=\"language-text\">AbstractXlsxView</code></strong> 클래스는 <strong><code class=\"language-text\">AbstractView</code></strong>를 확장하여 Excel 파일을 생성하는 방법을 정의합니다. 이 클래스의 주요 메서드와 동작 과정을 살펴보겠습니다</p>\n<ol>\n<li><strong><code class=\"language-text\">AbstractView</code></strong> render 호출</li>\n<li>\n<p><strong><code class=\"language-text\">AbstractXlsxView</code></strong> renderMergedOutputModel 메서드 호출 </p>\n<ol>\n<li>createWorkbook 메서드</li>\n<li><strong>buildExcelDocument</strong> 메서드 : 이 메서드는 실제로 Excel 파일의 내용을 작성하는 곳입니다. <strong>서브클래스에서 이 메서드를 구현하여 Excel 파일의 내용을 작성</strong>합니다.</li>\n<li>renderWorkbook 메서드</li>\n</ol>\n</li>\n</ol>\n<aside>\n➡️ 다음 포스팅에서 실제 코드를 작성해보자\n</aside>\n<br>\n<blockquote>\n<p> 출처<br>\n<a href=\"https://velog.io/@wleo04/POI-library-excel-HSSF-XSSF-SXSSF\">https://velog.io/@wleo04/POI-library-excel-HSSF-XSSF-SXSSF</a></p>\n<p><a href=\"https://m.blog.naver.com/rinjyu/221247979376\">https://m.blog.naver.com/rinjyu/221247979376</a></p>\n<p><a href=\"https://velog.io/@haerong22/Spring-%EC%97%91%EC%85%80-%ED%8C%8C%EC%9D%BC-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C-%ED%95%98%EA%B8%B0\">https://velog.io/@haerong22/Spring-엑셀-파일-다운로드-하기</a></p>\n</blockquote>","frontmatter":{"title":"[SpringBoot] Apache POI, AbstractView - 엑셀 파일 생성 후 다운로드 (1)","date":"May 28, 2024","tags":["SpringBoot","ApachePOI"]}}},"pageContext":{"slug":"/Spring/240528_poi_excel_1/","previous":{"fields":{"slug":"/Cpp/STL/01_cmath,algorithm,numeric/"},"frontmatter":{"title":"[C++] STL/cmath, algorithm, numeric","category":"Language/C++"}},"next":{"fields":{"slug":"/Spring/240528_poi_excel_2/"},"frontmatter":{"title":"[SpringBoot] Apache POI, AbstractView - 엑셀 파일 생성 후 다운로드 (2)","category":"Framework/Spring"}}}}}