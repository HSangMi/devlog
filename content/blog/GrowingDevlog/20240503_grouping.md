---
title: '[Gatsby] ë¸”ë¡œê·¸ì— ì¹´í…Œê³ ë¦¬ ê·¸ë£¹í•‘í•˜ê¸°'
date: 2024-05-03 19:20
category: 'Work & Dev/GrowingDevlog'
draft: false
tags:
    - Gatsby
    - React
---

ë³¸ê²©ì ìœ¼ë¡œ ë¸”ë¡œê·¸ë¥¼ ê´€ë¦¬í•´ë³´ë ¤ê³  í•˜ëŠ”ë°, ë²Œì¨ë¶€í„° ì¹´í…Œê³ ë¦¬ê°€ ë§ì•„ì§€ë©´ ë¶ˆí¸í•  ê²ƒ ê°™ë‹¤ëŠ” ê±±ì •ì„ ì‚¬ì„œí•˜ê¸° ì‹œì‘í–ˆë‹¤.  
ì¹´í…Œê³ ë¦¬ë¥¼ ê·¸ë£¹í•‘ í•˜ê³ ì‹¶ì€ë°, ê°€ì ¸ì˜¨ ë¸”ë¡œê·¸ í…Œë§ˆì˜ ì¹´í…Œê³ ë¦¬ UIì—ëŠ” ì ì ˆí•˜ì§€ ì•Šì•˜ë‹¤.
ê·¸ë ‡ë‹¤ê³  í¬ê²Œ êµ¬ì¡°ë¥¼ ê°œì„ í•˜ê¸°ì—” reactì™€ graphqlì— ëŒ€í•œ ì§€ì‹ì´ ë¶€ì¡±í•˜ê¸° ë–„ë¬¸ì— ìš°ì„  í¬ìŠ¤íŒ… í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ë§Œë“œëŠ” ê²ƒì— ì§‘ì¤‘í•˜ê¸°ë¡œ í•˜ê³  ~~ì•¼ë§¤~~ë¡œ í•´ë³´ê¸°ë¡œ í–ˆë‹¤.  
(ë¦¬ì•¡íŠ¸ì™€ graphqlì„ ì°¨ì°¨ .. ê³µë¶€í•´ë³´ë„ë¡ í•˜ìŸˆã…ã…)

<aside>
ì•„ì´ë””ì–´ ğŸ’¡ ì¹´í…Œê³ ë¦¬ë¥¼ '/'ë¡œ êµ¬ë¶„ì§€ì–´ ìƒìœ„ ì¹´í…Œê³ ë¦¬ë¥¼ ë§Œë“¤ì–´ ì£¼ì!
</aside>

### as-is ì¹´í…Œê³ ë¦¬
 ![](./images/asis_cate.png)

### to-be ì¹´í…Œê³ ë¦¬  
![](./images/tobe_cate.png)


----
### ì†ŒìŠ¤ ìˆ˜ì •
#### 1. CSSë¡œ ëŒ€ê°• ìœ„ì¹˜ë¥¼ ì¡ì•„ì¤Œ  

  - ì¹´í…Œê³ ë¦¬(sidebar ì™¼ìª½ìœ¼ë¡œ ì´ë™) `src\components\category\index.scss`

    ```scss
        .sidebar {
    +    position: fixed;
    +    display: block;
        }

        .category-container {
            position: sticky;
            position: -webkit-sticky;
            top: 0;
            line-height: 0;
            white-space: nowrap;
            overflow-x: scroll;
            -ms-overflow-style: none; // IE 10+
            overflow: -moz-scrollbars-none; // Firefox
            z-index: 1;
            padding: 6px 20px;
    +       width: 300px;           
    +       list-style: none;

            .item {
    +           // display: inline-block; -- ê°€ë¡œë¡œ ë‚˜ì—´í•˜ë˜ ë¶€ë¶„ ì£¼ì„
                margin: 0.25rem 6px 0.25rem 0;
                border-radius: 5px;
                white-space: normal;
                box-sizing: border-box;
                cursor: pointer;

                div {
                display: block;
                padding: 14px 16px 16px 16px;
                font-size: 13px;
                box-sizing: border-box;
                }
            }
            // ...
        }

    ```

  * ì¸ë„¤ì¼ ì»¨í…Œì´ë„ˆ ìš°ì¸¡ìœ¼ë¡œ ë°€ê¸° `src\components\thumbnail-container\index.scss`
    ```scss
        .thumbnail-container {
        min-height: calc(100vh - 3.5rem);
    +   padding-left: 300px;
        }
    ```


#### 2. ê¸°ì¡´ ê²Œì‹œê¸€ ì¹´í…Œê³ ë¦¬ë¥¼ ìƒìœ„ ì¹´í…Œê³ ë¦¬ë¥¼ ì§€ì •í•´ì„œ êµ¬ì¡°í™” ì‹œì¼œ post ì—…ë°ì´íŠ¸ 
  * ì¹´í…Œê³ ë¦¬ êµ¬ìƒì•ˆ
    ```
    Dev/GrowingDevlog
    Lanaguage/Java
    Lanaguage/C++
    Knowledge/DesignPattern
    ...
    ```
  * post ì—…ë°ì´íŠ¸ ì˜ˆì‹œ  

    ```
        ---
        title: '2. Adapter Pattern'
        date: 2022-09-22 00:00:00
        category: 'Knowledge/DesignPattern' // <-- ì¹´í…Œê³ ë¦¬ êµ¬ì¡°í™”
        draft: false
        tags: 
        - DesignPattern
        ---
    ```
  * ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ êµ¬ë¶„ìš© í¬ìŠ¤íŠ¸ ì¶”ê°€
    ```
        blog
        â”” CategoryDivider
            â”” dev.md
            â”” knowledge.md
            â”” language.md
    ```

#### 3. ì¹´í…Œê³ ë¦¬ ì •ë ¬ ì¶”ê°€í•˜ê¸°   
  - ì¹´í…Œê³ ë¦¬ ì´ë¦„ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê¸° `src\pages\index.js`  

    ```javscript
    // ì¹´í…Œê³ ë¦¬, ê²Œì‹œê¸€ ì •ë ¬ 
    export const pageQuery = graphql`
    query {
        //...
        allMarkdownRemark(
    +   sort: { fields: [frontmatter___category, frontmatter___date], order:[ASC, DESC] }
        filter: { frontmatter: { category: { ne: null }, draft: { eq: false } } }
        ) {
        // ...
        }
    }
    `
    ```

### ì¤‘ê°„ì ê²€
 ![](./images/middle_check_grouping.png)

 (1) ì‚¬ì´ë“œë°” ìˆ˜ì •
    - í•˜ìœ„ ì¹´í…Œê³ ë¦¬ì—ì„œ ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ ì•ˆë³´ì´ê²Œ í•˜ê¸°
    - ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ ì‚¬ì´ë“œ ë°”ì—ì„œ ì„ íƒ ì•ˆë˜ë„ë¡ ë§‰ê¸°, CSS ë³€ê²½í•˜ê¸°
 (2) ì™¼ìª½ í¬ìŠ¤íŠ¸ ëª©ë¡(thumbnail)ì—ì„œ ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ìš© post ìˆ¨ê¸°ê¸°


#### 4. ì‚¬ì´ë“œ ë°” ìˆ˜ì •
  * í•˜ìœ„ ì¹´í…Œê³ ë¦¬ì—ì„œ ê·¸ë£¹ ì•ˆë³´ì´ê²Œ í•˜ê¸°
  * ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ í´ë¦­ í–ˆì„ ë•Œ, ë™ì‘ ì•ˆí•˜ê²Œ ì²˜ë¦¬
  * `src\components\category\index.jsx`
    ```jsx
    // ...
      return (
        <div className="sidebar">
            <ul
              ref={containerRef}
              className="category-container"
              role="tablist"
              id="category"
              style={{
                margin: `0 -${rhythm(3 / 4)}`,
              }}
            >
              <Item title={'All'} selectedCategory={category} onClick={selectCategory} scrollToCenter={scrollToCenter} />
        +        {categories.map((title, idx) => {
        +          let cArr = title.split('/');           // '/'ë¡œ êµ¬ë¶„í•˜ì—¬ ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ì¸ì§€, ì¹´í…Œê³ ë¦¬ì¸ì§€ íŒë‹¨
        +          if (cArr.length == 1) {
        +            return (
        +              <Item
        +                key={idx}
        +                title={title}
        +                selectedCategory={category}
        +                onClick={selectCategory}
        +                scrollToCenter={scrollToCenter}
        +                disable={true}                   // ë™ì‘ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ í”Œë˜ê·¸ ë³€ìˆ˜ ì¶”ê°€
        +              />
        +            )
        +          } else {
        +            return (
        +              <Item
        +                key={idx}
        +                title={title}
        +                selectedCategory={category}
        +                onClick={selectCategory}
        +                scrollToCenter={scrollToCenter}
        +                disable={false}
        +              />
        +            )
        +          }
        +        })}
            </ul>
          </div>
        )
      }
    ```
  * `src\components\category\item\index.jsx`
    ```jsx
    + export const Item = ({ title, selectedCategory, onClick, scrollToCenter, disable }) => {  // ì „ë‹¬ë°›ì€ disable í”Œë˜ê·¸ë¡œ ì²˜ë¦¬
        const tabRef = useRef(null)

        const handleClick = useCallback(() => {
          scrollToCenter(tabRef)
          onClick(title)
        }, [tabRef])

        useEffect(() => {
          if (selectedCategory === title) {
            scrollToCenter(tabRef)
          }
        }, [selectedCategory, tabRef])

    +   let showTitle = title.split("/").pop();     // '/'ë¡œ êµ¬ë¶„í•œ ë¬¸ìì—´ì¤‘ ë§ˆì§€ë§‰ title ì‚¬ìš©
        return (
          <li
            ref={tabRef}
    +       className={disable != true ? "item" : "item_group"}   // ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ê³¼ css ë‹¤ë¥´ê²Œ ì ìš©
            role="tab"
            aria-selected={selectedCategory === title ? 'true' : 'false'}
          >
    +       <div onClick={disable != true ? handleClick : null}>{showTitle}</div>   // í´ë¦­ ë™ì‘ ì œê±°
          </li>
        )
    ```

  * ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ css ë³€ê²½í•˜ê¸°
    * `src\components\category\index.scss`
      ```scss
      +    .item_group {
      +    margin: 0.25rem 6px 0.25rem 0;
      +    white-space: normal;
      +    box-sizing: border-box;
      +    color: #a5a5a5;
      +    div {
      +      display: block;
      +      padding: 14px 16px 16px 16px;
      +      font-size: 13px;
      +      box-sizing: border-box;
      +    }
      +  }
      ```

#### 5. í¬ìŠ¤íŠ¸ ëª©ë¡(thumbnail)ì—ì„œ ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ìš© í¬ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸°
  * `src\components\contents\index.jsx`
    ```jsx
    // ...
      const refinedPosts = useMemo(() =>
      posts
        .filter(
          ({ node }) =>
    +       node.frontmatter.category.split("/").length > 1 && (
              category === CATEGORY_TYPE.ALL ||
              node.frontmatter.category === category)
        )
        .slice(0, count * countOfInitialPost)
    )
    // ...
    ```


#### ì™„ì„±!
![](./images/categroup_compleate.png)



#### + ì¶”ê°€ì‘ì—…
1. thnumbnail context ì •ë ¬
2. ì´ì „ê¸€ ë³´ê¸°/ë‹¤ìŒê¸€ ë³´ê¸°ì— ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ ë…¸ì¶œ

#### 1. thnumbnail context ì •ë ¬
  * category ìˆœìœ¼ë¡œ ìš°ì„  ì •ë ¬ë˜ì–´, `All` íƒ­ì¼ ê²½ìš°, ì‹œê°„ìˆœìœ¼ë¡œ ë³´ì´ì§€ ì•ŠìŒ
  * `src\components\thumbnail-container\index.jsx` íŒŒì¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •
    ```jsx
    import React from 'react'

    import './index.scss'

    export const ThumbnailContainer = React.memo(({ children }) => {
      // childrenì„ ë³µì‚¬í•˜ì—¬ ë°°ì—´ë¡œ ë§Œë“¤ê¸°
      const childrenArray = React.Children.toArray(children);

      // ë‚ ì§œ ì†ì„±ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
      childrenArray.sort((a, b) => {
      // ë‚ ì§œ ì†ì„±ì„ ë¹„êµí•˜ì—¬ ì •ë ¬
        const dateA = new Date(a.props.node.frontmatter.date);
        const dateB = new Date(b.props.node.frontmatter.date);
        return dateB - dateA ; // ë‚´ë¦¼ì°¨ìˆœ
      });
      return <div className="thumbnail-container">{childrenArray}</div>;
    });
    ```


#### 2. ì´ì „ê¸€ ë³´ê¸°/ë‹¤ìŒê¸€ ë³´ê¸°ì— ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ ë…¸ì¶œ
1. previous, next ì •ë³´ì— category ì¶”ê°€í•˜ê¸° (ì¹´í…Œê³ ë¦¬ ê·¸ë£¹ íŒë‹¨ìš©)
  - `gatsby-node.js`
    ```javascript
              previous {
                fields {
                  slug
                }
                frontmatter {
                  title
    +             category
                }
              }
              next {
                fields {
                  slug
                }
                frontmatter {
                  title
    +             category
                }
              }
    ```

2. ì¡°ê±´ì— ë”°ë¼ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
  - `\components\post-navigator\index.jsx`
    ```jsx
        const { previous, next } = pageContext

      + let hasPrev = previous && previous.frontmatter.category && previous.frontmatter.category.split('/').length > 1;
      + let hasNext = next && next.frontmatter.category && next.frontmatter.category.split('/').length > 1;

        return (
          <ul className="navigator">
            <li>
      +       {hasPrev && (
                <Link to={previous.fields.slug} rel="prev">
                  â† {previous.frontmatter.title}
                </Link>
              )}
            </li>
            <li>
      +       {hasNext && (
                <Link to={next.fields.slug} rel="next">
                  {next.frontmatter.title} â†’
                </Link>
              )}
    ```

#### ë‚¨ê²¨ì§„ ê³¼ì œ
  1. ë°˜ì‘í˜• UI
  2. ì´ë¦„ìˆœì´ ì•„ë‹Œ ì •ë ¬